#include "aoaComFun.h"

#include <stdio.h>
#include <stdlib.h>


#define Pi2Codic (COMFUN_CODIC_LUT[0]<<1)
//Tqa related setting
static int TqaPb       = (PI_QUNT_BIT-1);      // unsigned , trignometric quadruple angle phase quantization bit [0 pi/2]
static int TqaAb       = TQA_AMP_BIT;          // signed,    trigonmetric quadruple angle amplitude quantization bit
static int TqaX2b      = (PI_QUNT_BIT-1);      // unsigned,  trignometric quadruple angle internal x^2 quantization bit
static int TqaX4b      = (PI_QUNT_BIT-1);      // unsigned,  trignometric quadruple angle internal (x^2)*(x^2) quantization bit
#define Pi2Tqa (1 << TqaPb)

//16384 -> pi/4 --> atan(2^(0:-1:n-1))/atan(1) n = 14
const int COMFUN_CODIC_LUT[COMFUN_CORDIC_ITR_MAX+1] = {\
                                                       16384, 9672, 5110, 2594, 1302, 652, 326, 163, 81, 41, 20, 10, 5, 3, 1
                                                      };

#if (_PHASE_LUT_USE_==PHASE_LUT_USE_TQALUT)
// tab should be 2^N +1 for [0 pi/2]
const uint16_t PHASE_LUT_TQA_LUT[4096+1] =
{
    4095,  4095,  4095,  4095,  4095,  4095,  4095,  4095,  4095,  4095,\
    4095,  4095,  4095,  4095,  4095,  4095,  4095,  4095,  4095,  4095,\
    4095,  4095,  4095,  4095,  4095,  4095,  4095,  4095,  4095,  4095,\
    4095,  4095,  4095,  4095,  4095,  4095,  4095,  4095,  4095,  4095,\
    4095,  4094,  4094,  4094,  4094,  4094,  4094,  4094,  4094,  4094,\
    4094,  4094,  4094,  4094,  4094,  4094,  4094,  4094,  4094,  4094,\
    4094,  4094,  4094,  4094,  4094,  4094,  4094,  4094,  4094,  4094,\
    4094,  4093,  4093,  4093,  4093,  4093,  4093,  4093,  4093,  4093,\
    4093,  4093,  4093,  4093,  4093,  4093,  4093,  4093,  4093,  4093,\
    4093,  4093,  4092,  4092,  4092,  4092,  4092,  4092,  4092,  4092,\
    4092,  4092,  4092,  4092,  4092,  4092,  4092,  4092,  4091,  4091,\
    4091,  4091,  4091,  4091,  4091,  4091,  4091,  4091,  4091,  4091,\
    4091,  4091,  4091,  4090,  4090,  4090,  4090,  4090,  4090,  4090,\
    4090,  4090,  4090,  4090,  4090,  4090,  4089,  4089,  4089,  4089,\
    4089,  4089,  4089,  4089,  4089,  4089,  4089,  4088,  4088,  4088,\
    4088,  4088,  4088,  4088,  4088,  4088,  4088,  4088,  4087,  4087,\
    4087,  4087,  4087,  4087,  4087,  4087,  4087,  4087,  4087,  4086,\
    4086,  4086,  4086,  4086,  4086,  4086,  4086,  4086,  4085,  4085,\
    4085,  4085,  4085,  4085,  4085,  4085,  4085,  4084,  4084,  4084,\
    4084,  4084,  4084,  4084,  4084,  4084,  4083,  4083,  4083,  4083,\
    4083,  4083,  4083,  4083,  4082,  4082,  4082,  4082,  4082,  4082,\
    4082,  4082,  4081,  4081,  4081,  4081,  4081,  4081,  4081,  4081,\
    4080,  4080,  4080,  4080,  4080,  4080,  4080,  4079,  4079,  4079,\
    4079,  4079,  4079,  4079,  4079,  4078,  4078,  4078,  4078,  4078,\
    4078,  4078,  4077,  4077,  4077,  4077,  4077,  4077,  4076,  4076,\
    4076,  4076,  4076,  4076,  4076,  4075,  4075,  4075,  4075,  4075,\
    4075,  4075,  4074,  4074,  4074,  4074,  4074,  4074,  4073,  4073,\
    4073,  4073,  4073,  4073,  4072,  4072,  4072,  4072,  4072,  4072,\
    4071,  4071,  4071,  4071,  4071,  4071,  4070,  4070,  4070,  4070,\
    4070,  4070,  4069,  4069,  4069,  4069,  4069,  4068,  4068,  4068,\
    4068,  4068,  4068,  4067,  4067,  4067,  4067,  4067,  4066,  4066,\
    4066,  4066,  4066,  4066,  4065,  4065,  4065,  4065,  4065,  4064,\
    4064,  4064,  4064,  4064,  4063,  4063,  4063,  4063,  4063,  4062,\
    4062,  4062,  4062,  4062,  4061,  4061,  4061,  4061,  4061,  4060,\
    4060,  4060,  4060,  4060,  4059,  4059,  4059,  4059,  4059,  4058,\
    4058,  4058,  4058,  4058,  4057,  4057,  4057,  4057,  4056,  4056,\
    4056,  4056,  4056,  4055,  4055,  4055,  4055,  4055,  4054,  4054,\
    4054,  4054,  4053,  4053,  4053,  4053,  4053,  4052,  4052,  4052,\
    4052,  4051,  4051,  4051,  4051,  4050,  4050,  4050,  4050,  4050,\
    4049,  4049,  4049,  4049,  4048,  4048,  4048,  4048,  4047,  4047,\
    4047,  4047,  4046,  4046,  4046,  4046,  4045,  4045,  4045,  4045,\
    4044,  4044,  4044,  4044,  4043,  4043,  4043,  4043,  4042,  4042,\
    4042,  4042,  4041,  4041,  4041,  4041,  4040,  4040,  4040,  4040,\
    4039,  4039,  4039,  4039,  4038,  4038,  4038,  4038,  4037,  4037,\
    4037,  4037,  4036,  4036,  4036,  4036,  4035,  4035,  4035,  4034,\
    4034,  4034,  4034,  4033,  4033,  4033,  4033,  4032,  4032,  4032,\
    4031,  4031,  4031,  4031,  4030,  4030,  4030,  4030,  4029,  4029,\
    4029,  4028,  4028,  4028,  4028,  4027,  4027,  4027,  4026,  4026,\
    4026,  4026,  4025,  4025,  4025,  4024,  4024,  4024,  4023,  4023,\
    4023,  4023,  4022,  4022,  4022,  4021,  4021,  4021,  4021,  4020,\
    4020,  4020,  4019,  4019,  4019,  4018,  4018,  4018,  4018,  4017,\
    4017,  4017,  4016,  4016,  4016,  4015,  4015,  4015,  4014,  4014,\
    4014,  4014,  4013,  4013,  4013,  4012,  4012,  4012,  4011,  4011,\
    4011,  4010,  4010,  4010,  4009,  4009,  4009,  4008,  4008,  4008,\
    4008,  4007,  4007,  4007,  4006,  4006,  4006,  4005,  4005,  4005,\
    4004,  4004,  4004,  4003,  4003,  4003,  4002,  4002,  4002,  4001,\
    4001,  4001,  4000,  4000,  4000,  3999,  3999,  3999,  3998,  3998,\
    3998,  3997,  3997,  3997,  3996,  3996,  3996,  3995,  3995,  3994,\
    3994,  3994,  3993,  3993,  3993,  3992,  3992,  3992,  3991,  3991,\
    3991,  3990,  3990,  3990,  3989,  3989,  3989,  3988,  3988,  3987,\
    3987,  3987,  3986,  3986,  3986,  3985,  3985,  3985,  3984,  3984,\
    3983,  3983,  3983,  3982,  3982,  3982,  3981,  3981,  3981,  3980,\
    3980,  3979,  3979,  3979,  3978,  3978,  3978,  3977,  3977,  3976,\
    3976,  3976,  3975,  3975,  3975,  3974,  3974,  3973,  3973,  3973,\
    3972,  3972,  3972,  3971,  3971,  3970,  3970,  3970,  3969,  3969,\
    3968,  3968,  3968,  3967,  3967,  3966,  3966,  3966,  3965,  3965,\
    3965,  3964,  3964,  3963,  3963,  3963,  3962,  3962,  3961,  3961,\
    3961,  3960,  3960,  3959,  3959,  3959,  3958,  3958,  3957,  3957,\
    3957,  3956,  3956,  3955,  3955,  3955,  3954,  3954,  3953,  3953,\
    3952,  3952,  3952,  3951,  3951,  3950,  3950,  3950,  3949,  3949,\
    3948,  3948,  3947,  3947,  3947,  3946,  3946,  3945,  3945,  3945,\
    3944,  3944,  3943,  3943,  3942,  3942,  3942,  3941,  3941,  3940,\
    3940,  3939,  3939,  3939,  3938,  3938,  3937,  3937,  3936,  3936,\
    3936,  3935,  3935,  3934,  3934,  3933,  3933,  3933,  3932,  3932,\
    3931,  3931,  3930,  3930,  3929,  3929,  3929,  3928,  3928,  3927,\
    3927,  3926,  3926,  3925,  3925,  3925,  3924,  3924,  3923,  3923,\
    3922,  3922,  3921,  3921,  3920,  3920,  3920,  3919,  3919,  3918,\
    3918,  3917,  3917,  3916,  3916,  3915,  3915,  3915,  3914,  3914,\
    3913,  3913,  3912,  3912,  3911,  3911,  3910,  3910,  3909,  3909,\
    3909,  3908,  3908,  3907,  3907,  3906,  3906,  3905,  3905,  3904,\
    3904,  3903,  3903,  3902,  3902,  3901,  3901,  3900,  3900,  3899,\
    3899,  3899,  3898,  3898,  3897,  3897,  3896,  3896,  3895,  3895,\
    3894,  3894,  3893,  3893,  3892,  3892,  3891,  3891,  3890,  3890,\
    3889,  3889,  3888,  3888,  3887,  3887,  3886,  3886,  3885,  3885,\
    3884,  3884,  3883,  3883,  3882,  3882,  3881,  3881,  3880,  3880,\
    3879,  3879,  3878,  3878,  3877,  3877,  3876,  3876,  3875,  3875,\
    3874,  3874,  3873,  3873,  3872,  3872,  3871,  3871,  3870,  3870,\
    3869,  3869,  3868,  3868,  3867,  3867,  3866,  3866,  3865,  3865,\
    3864,  3863,  3863,  3862,  3862,  3861,  3861,  3860,  3860,  3859,\
    3859,  3858,  3858,  3857,  3857,  3856,  3856,  3855,  3855,  3854,\
    3854,  3853,  3852,  3852,  3851,  3851,  3850,  3850,  3849,  3849,\
    3848,  3848,  3847,  3847,  3846,  3845,  3845,  3844,  3844,  3843,\
    3843,  3842,  3842,  3841,  3841,  3840,  3839,  3839,  3838,  3838,\
    3837,  3837,  3836,  3836,  3835,  3835,  3834,  3833,  3833,  3832,\
    3832,  3831,  3831,  3830,  3830,  3829,  3828,  3828,  3827,  3827,\
    3826,  3826,  3825,  3825,  3824,  3823,  3823,  3822,  3822,  3821,\
    3821,  3820,  3819,  3819,  3818,  3818,  3817,  3817,  3816,  3815,\
    3815,  3814,  3814,  3813,  3813,  3812,  3811,  3811,  3810,  3810,\
    3809,  3809,  3808,  3807,  3807,  3806,  3806,  3805,  3805,  3804,\
    3803,  3803,  3802,  3802,  3801,  3800,  3800,  3799,  3799,  3798,\
    3798,  3797,  3796,  3796,  3795,  3795,  3794,  3793,  3793,  3792,\
    3792,  3791,  3790,  3790,  3789,  3789,  3788,  3787,  3787,  3786,\
    3786,  3785,  3784,  3784,  3783,  3783,  3782,  3781,  3781,  3780,\
    3780,  3779,  3778,  3778,  3777,  3777,  3776,  3775,  3775,  3774,\
    3774,  3773,  3772,  3772,  3771,  3771,  3770,  3769,  3769,  3768,\
    3767,  3767,  3766,  3766,  3765,  3764,  3764,  3763,  3763,  3762,\
    3761,  3761,  3760,  3759,  3759,  3758,  3758,  3757,  3756,  3756,\
    3755,  3754,  3754,  3753,  3753,  3752,  3751,  3751,  3750,  3749,\
    3749,  3748,  3747,  3747,  3746,  3746,  3745,  3744,  3744,  3743,\
    3742,  3742,  3741,  3741,  3740,  3739,  3739,  3738,  3737,  3737,\
    3736,  3735,  3735,  3734,  3733,  3733,  3732,  3731,  3731,  3730,\
    3730,  3729,  3728,  3728,  3727,  3726,  3726,  3725,  3724,  3724,\
    3723,  3722,  3722,  3721,  3720,  3720,  3719,  3718,  3718,  3717,\
    3716,  3716,  3715,  3714,  3714,  3713,  3713,  3712,  3711,  3711,\
    3710,  3709,  3709,  3708,  3707,  3707,  3706,  3705,  3705,  3704,\
    3703,  3703,  3702,  3701,  3700,  3700,  3699,  3698,  3698,  3697,\
    3696,  3696,  3695,  3694,  3694,  3693,  3692,  3692,  3691,  3690,\
    3690,  3689,  3688,  3688,  3687,  3686,  3686,  3685,  3684,  3684,\
    3683,  3682,  3681,  3681,  3680,  3679,  3679,  3678,  3677,  3677,\
    3676,  3675,  3675,  3674,  3673,  3672,  3672,  3671,  3670,  3670,\
    3669,  3668,  3668,  3667,  3666,  3665,  3665,  3664,  3663,  3663,\
    3662,  3661,  3661,  3660,  3659,  3658,  3658,  3657,  3656,  3656,\
    3655,  3654,  3654,  3653,  3652,  3651,  3651,  3650,  3649,  3649,\
    3648,  3647,  3646,  3646,  3645,  3644,  3644,  3643,  3642,  3641,\
    3641,  3640,  3639,  3638,  3638,  3637,  3636,  3636,  3635,  3634,\
    3633,  3633,  3632,  3631,  3631,  3630,  3629,  3628,  3628,  3627,\
    3626,  3625,  3625,  3624,  3623,  3623,  3622,  3621,  3620,  3620,\
    3619,  3618,  3617,  3617,  3616,  3615,  3614,  3614,  3613,  3612,\
    3611,  3611,  3610,  3609,  3609,  3608,  3607,  3606,  3606,  3605,\
    3604,  3603,  3603,  3602,  3601,  3600,  3600,  3599,  3598,  3597,\
    3597,  3596,  3595,  3594,  3594,  3593,  3592,  3591,  3591,  3590,\
    3589,  3588,  3588,  3587,  3586,  3585,  3584,  3584,  3583,  3582,\
    3581,  3581,  3580,  3579,  3578,  3578,  3577,  3576,  3575,  3575,\
    3574,  3573,  3572,  3571,  3571,  3570,  3569,  3568,  3568,  3567,\
    3566,  3565,  3565,  3564,  3563,  3562,  3561,  3561,  3560,  3559,\
    3558,  3558,  3557,  3556,  3555,  3554,  3554,  3553,  3552,  3551,\
    3551,  3550,  3549,  3548,  3547,  3547,  3546,  3545,  3544,  3543,\
    3543,  3542,  3541,  3540,  3540,  3539,  3538,  3537,  3536,  3536,\
    3535,  3534,  3533,  3532,  3532,  3531,  3530,  3529,  3528,  3528,\
    3527,  3526,  3525,  3524,  3524,  3523,  3522,  3521,  3520,  3520,\
    3519,  3518,  3517,  3516,  3516,  3515,  3514,  3513,  3512,  3512,\
    3511,  3510,  3509,  3508,  3508,  3507,  3506,  3505,  3504,  3503,\
    3503,  3502,  3501,  3500,  3499,  3499,  3498,  3497,  3496,  3495,\
    3495,  3494,  3493,  3492,  3491,  3490,  3490,  3489,  3488,  3487,\
    3486,  3485,  3485,  3484,  3483,  3482,  3481,  3481,  3480,  3479,\
    3478,  3477,  3476,  3476,  3475,  3474,  3473,  3472,  3471,  3471,\
    3470,  3469,  3468,  3467,  3466,  3466,  3465,  3464,  3463,  3462,\
    3461,  3461,  3460,  3459,  3458,  3457,  3456,  3455,  3455,  3454,\
    3453,  3452,  3451,  3450,  3450,  3449,  3448,  3447,  3446,  3445,\
    3444,  3444,  3443,  3442,  3441,  3440,  3439,  3439,  3438,  3437,\
    3436,  3435,  3434,  3433,  3433,  3432,  3431,  3430,  3429,  3428,\
    3427,  3427,  3426,  3425,  3424,  3423,  3422,  3421,  3420,  3420,\
    3419,  3418,  3417,  3416,  3415,  3414,  3414,  3413,  3412,  3411,\
    3410,  3409,  3408,  3407,  3407,  3406,  3405,  3404,  3403,  3402,\
    3401,  3400,  3400,  3399,  3398,  3397,  3396,  3395,  3394,  3393,\
    3393,  3392,  3391,  3390,  3389,  3388,  3387,  3386,  3386,  3385,\
    3384,  3383,  3382,  3381,  3380,  3379,  3378,  3378,  3377,  3376,\
    3375,  3374,  3373,  3372,  3371,  3370,  3370,  3369,  3368,  3367,\
    3366,  3365,  3364,  3363,  3362,  3362,  3361,  3360,  3359,  3358,\
    3357,  3356,  3355,  3354,  3353,  3353,  3352,  3351,  3350,  3349,\
    3348,  3347,  3346,  3345,  3344,  3343,  3343,  3342,  3341,  3340,\
    3339,  3338,  3337,  3336,  3335,  3334,  3333,  3333,  3332,  3331,\
    3330,  3329,  3328,  3327,  3326,  3325,  3324,  3323,  3322,  3322,\
    3321,  3320,  3319,  3318,  3317,  3316,  3315,  3314,  3313,  3312,\
    3311,  3311,  3310,  3309,  3308,  3307,  3306,  3305,  3304,  3303,\
    3302,  3301,  3300,  3299,  3298,  3298,  3297,  3296,  3295,  3294,\
    3293,  3292,  3291,  3290,  3289,  3288,  3287,  3286,  3285,  3284,\
    3284,  3283,  3282,  3281,  3280,  3279,  3278,  3277,  3276,  3275,\
    3274,  3273,  3272,  3271,  3270,  3269,  3268,  3267,  3267,  3266,\
    3265,  3264,  3263,  3262,  3261,  3260,  3259,  3258,  3257,  3256,\
    3255,  3254,  3253,  3252,  3251,  3250,  3249,  3248,  3248,  3247,\
    3246,  3245,  3244,  3243,  3242,  3241,  3240,  3239,  3238,  3237,\
    3236,  3235,  3234,  3233,  3232,  3231,  3230,  3229,  3228,  3227,\
    3226,  3225,  3224,  3223,  3222,  3222,  3221,  3220,  3219,  3218,\
    3217,  3216,  3215,  3214,  3213,  3212,  3211,  3210,  3209,  3208,\
    3207,  3206,  3205,  3204,  3203,  3202,  3201,  3200,  3199,  3198,\
    3197,  3196,  3195,  3194,  3193,  3192,  3191,  3190,  3189,  3188,\
    3187,  3186,  3185,  3184,  3183,  3182,  3181,  3180,  3179,  3178,\
    3177,  3176,  3175,  3174,  3173,  3172,  3171,  3170,  3169,  3168,\
    3167,  3166,  3165,  3164,  3163,  3162,  3161,  3160,  3159,  3158,\
    3157,  3156,  3155,  3154,  3153,  3152,  3151,  3150,  3149,  3148,\
    3147,  3146,  3145,  3144,  3143,  3142,  3141,  3140,  3139,  3138,\
    3137,  3136,  3135,  3134,  3133,  3132,  3131,  3130,  3129,  3128,\
    3127,  3126,  3125,  3124,  3123,  3122,  3121,  3120,  3119,  3118,\
    3117,  3116,  3115,  3114,  3113,  3112,  3111,  3110,  3109,  3108,\
    3107,  3106,  3105,  3104,  3103,  3102,  3101,  3100,  3099,  3098,\
    3097,  3096,  3095,  3094,  3093,  3092,  3090,  3089,  3088,  3087,\
    3086,  3085,  3084,  3083,  3082,  3081,  3080,  3079,  3078,  3077,\
    3076,  3075,  3074,  3073,  3072,  3071,  3070,  3069,  3068,  3067,\
    3066,  3065,  3064,  3063,  3061,  3060,  3059,  3058,  3057,  3056,\
    3055,  3054,  3053,  3052,  3051,  3050,  3049,  3048,  3047,  3046,\
    3045,  3044,  3043,  3042,  3041,  3039,  3038,  3037,  3036,  3035,\
    3034,  3033,  3032,  3031,  3030,  3029,  3028,  3027,  3026,  3025,\
    3024,  3023,  3022,  3020,  3019,  3018,  3017,  3016,  3015,  3014,\
    3013,  3012,  3011,  3010,  3009,  3008,  3007,  3006,  3004,  3003,\
    3002,  3001,  3000,  2999,  2998,  2997,  2996,  2995,  2994,  2993,\
    2992,  2991,  2990,  2988,  2987,  2986,  2985,  2984,  2983,  2982,\
    2981,  2980,  2979,  2978,  2977,  2976,  2974,  2973,  2972,  2971,\
    2970,  2969,  2968,  2967,  2966,  2965,  2964,  2963,  2961,  2960,\
    2959,  2958,  2957,  2956,  2955,  2954,  2953,  2952,  2951,  2949,\
    2948,  2947,  2946,  2945,  2944,  2943,  2942,  2941,  2940,  2939,\
    2937,  2936,  2935,  2934,  2933,  2932,  2931,  2930,  2929,  2928,\
    2927,  2925,  2924,  2923,  2922,  2921,  2920,  2919,  2918,  2917,\
    2916,  2914,  2913,  2912,  2911,  2910,  2909,  2908,  2907,  2906,\
    2904,  2903,  2902,  2901,  2900,  2899,  2898,  2897,  2896,  2894,\
    2893,  2892,  2891,  2890,  2889,  2888,  2887,  2886,  2884,  2883,\
    2882,  2881,  2880,  2879,  2878,  2877,  2876,  2874,  2873,  2872,\
    2871,  2870,  2869,  2868,  2867,  2865,  2864,  2863,  2862,  2861,\
    2860,  2859,  2858,  2856,  2855,  2854,  2853,  2852,  2851,  2850,\
    2849,  2847,  2846,  2845,  2844,  2843,  2842,  2841,  2840,  2838,\
    2837,  2836,  2835,  2834,  2833,  2832,  2830,  2829,  2828,  2827,\
    2826,  2825,  2824,  2823,  2821,  2820,  2819,  2818,  2817,  2816,\
    2815,  2813,  2812,  2811,  2810,  2809,  2808,  2807,  2805,  2804,\
    2803,  2802,  2801,  2800,  2799,  2797,  2796,  2795,  2794,  2793,\
    2792,  2791,  2789,  2788,  2787,  2786,  2785,  2784,  2782,  2781,\
    2780,  2779,  2778,  2777,  2776,  2774,  2773,  2772,  2771,  2770,\
    2769,  2767,  2766,  2765,  2764,  2763,  2762,  2760,  2759,  2758,\
    2757,  2756,  2755,  2754,  2752,  2751,  2750,  2749,  2748,  2747,\
    2745,  2744,  2743,  2742,  2741,  2740,  2738,  2737,  2736,  2735,\
    2734,  2733,  2731,  2730,  2729,  2728,  2727,  2726,  2724,  2723,\
    2722,  2721,  2720,  2718,  2717,  2716,  2715,  2714,  2713,  2711,\
    2710,  2709,  2708,  2707,  2706,  2704,  2703,  2702,  2701,  2700,\
    2698,  2697,  2696,  2695,  2694,  2693,  2691,  2690,  2689,  2688,\
    2687,  2685,  2684,  2683,  2682,  2681,  2679,  2678,  2677,  2676,\
    2675,  2674,  2672,  2671,  2670,  2669,  2668,  2666,  2665,  2664,\
    2663,  2662,  2660,  2659,  2658,  2657,  2656,  2654,  2653,  2652,\
    2651,  2650,  2648,  2647,  2646,  2645,  2644,  2642,  2641,  2640,\
    2639,  2638,  2636,  2635,  2634,  2633,  2632,  2630,  2629,  2628,\
    2627,  2626,  2624,  2623,  2622,  2621,  2620,  2618,  2617,  2616,\
    2615,  2614,  2612,  2611,  2610,  2609,  2608,  2606,  2605,  2604,\
    2603,  2601,  2600,  2599,  2598,  2597,  2595,  2594,  2593,  2592,\
    2591,  2589,  2588,  2587,  2586,  2584,  2583,  2582,  2581,  2580,\
    2578,  2577,  2576,  2575,  2573,  2572,  2571,  2570,  2569,  2567,\
    2566,  2565,  2564,  2562,  2561,  2560,  2559,  2558,  2556,  2555,\
    2554,  2553,  2551,  2550,  2549,  2548,  2547,  2545,  2544,  2543,\
    2542,  2540,  2539,  2538,  2537,  2535,  2534,  2533,  2532,  2531,\
    2529,  2528,  2527,  2526,  2524,  2523,  2522,  2521,  2519,  2518,\
    2517,  2516,  2514,  2513,  2512,  2511,  2509,  2508,  2507,  2506,\
    2504,  2503,  2502,  2501,  2500,  2498,  2497,  2496,  2495,  2493,\
    2492,  2491,  2490,  2488,  2487,  2486,  2485,  2483,  2482,  2481,\
    2480,  2478,  2477,  2476,  2475,  2473,  2472,  2471,  2470,  2468,\
    2467,  2466,  2465,  2463,  2462,  2461,  2460,  2458,  2457,  2456,\
    2454,  2453,  2452,  2451,  2449,  2448,  2447,  2446,  2444,  2443,\
    2442,  2441,  2439,  2438,  2437,  2436,  2434,  2433,  2432,  2431,\
    2429,  2428,  2427,  2425,  2424,  2423,  2422,  2420,  2419,  2418,\
    2417,  2415,  2414,  2413,  2412,  2410,  2409,  2408,  2406,  2405,\
    2404,  2403,  2401,  2400,  2399,  2398,  2396,  2395,  2394,  2392,\
    2391,  2390,  2389,  2387,  2386,  2385,  2384,  2382,  2381,  2380,\
    2378,  2377,  2376,  2375,  2373,  2372,  2371,  2369,  2368,  2367,\
    2366,  2364,  2363,  2362,  2361,  2359,  2358,  2357,  2355,  2354,\
    2353,  2352,  2350,  2349,  2348,  2346,  2345,  2344,  2343,  2341,\
    2340,  2339,  2337,  2336,  2335,  2333,  2332,  2331,  2330,  2328,\
    2327,  2326,  2324,  2323,  2322,  2321,  2319,  2318,  2317,  2315,\
    2314,  2313,  2311,  2310,  2309,  2308,  2306,  2305,  2304,  2302,\
    2301,  2300,  2299,  2297,  2296,  2295,  2293,  2292,  2291,  2289,\
    2288,  2287,  2285,  2284,  2283,  2282,  2280,  2279,  2278,  2276,\
    2275,  2274,  2272,  2271,  2270,  2269,  2267,  2266,  2265,  2263,\
    2262,  2261,  2259,  2258,  2257,  2255,  2254,  2253,  2252,  2250,\
    2249,  2248,  2246,  2245,  2244,  2242,  2241,  2240,  2238,  2237,\
    2236,  2234,  2233,  2232,  2230,  2229,  2228,  2227,  2225,  2224,\
    2223,  2221,  2220,  2219,  2217,  2216,  2215,  2213,  2212,  2211,\
    2209,  2208,  2207,  2205,  2204,  2203,  2201,  2200,  2199,  2197,\
    2196,  2195,  2193,  2192,  2191,  2189,  2188,  2187,  2186,  2184,\
    2183,  2182,  2180,  2179,  2178,  2176,  2175,  2174,  2172,  2171,\
    2170,  2168,  2167,  2166,  2164,  2163,  2162,  2160,  2159,  2158,\
    2156,  2155,  2154,  2152,  2151,  2150,  2148,  2147,  2146,  2144,\
    2143,  2142,  2140,  2139,  2137,  2136,  2135,  2133,  2132,  2131,\
    2129,  2128,  2127,  2125,  2124,  2123,  2121,  2120,  2119,  2117,\
    2116,  2115,  2113,  2112,  2111,  2109,  2108,  2107,  2105,  2104,\
    2103,  2101,  2100,  2099,  2097,  2096,  2094,  2093,  2092,  2090,\
    2089,  2088,  2086,  2085,  2084,  2082,  2081,  2080,  2078,  2077,\
    2076,  2074,  2073,  2071,  2070,  2069,  2067,  2066,  2065,  2063,\
    2062,  2061,  2059,  2058,  2057,  2055,  2054,  2052,  2051,  2050,\
    2048,  2047,  2046,  2044,  2043,  2042,  2040,  2039,  2038,  2036,\
    2035,  2033,  2032,  2031,  2029,  2028,  2027,  2025,  2024,  2023,\
    2021,  2020,  2018,  2017,  2016,  2014,  2013,  2012,  2010,  2009,\
    2007,  2006,  2005,  2003,  2002,  2001,  1999,  1998,  1997,  1995,\
    1994,  1992,  1991,  1990,  1988,  1987,  1986,  1984,  1983,  1981,\
    1980,  1979,  1977,  1976,  1975,  1973,  1972,  1970,  1969,  1968,\
    1966,  1965,  1964,  1962,  1961,  1959,  1958,  1957,  1955,  1954,\
    1952,  1951,  1950,  1948,  1947,  1946,  1944,  1943,  1941,  1940,\
    1939,  1937,  1936,  1935,  1933,  1932,  1930,  1929,  1928,  1926,\
    1925,  1923,  1922,  1921,  1919,  1918,  1917,  1915,  1914,  1912,\
    1911,  1910,  1908,  1907,  1905,  1904,  1903,  1901,  1900,  1898,\
    1897,  1896,  1894,  1893,  1891,  1890,  1889,  1887,  1886,  1885,\
    1883,  1882,  1880,  1879,  1878,  1876,  1875,  1873,  1872,  1871,\
    1869,  1868,  1866,  1865,  1864,  1862,  1861,  1859,  1858,  1857,\
    1855,  1854,  1852,  1851,  1850,  1848,  1847,  1845,  1844,  1843,\
    1841,  1840,  1838,  1837,  1836,  1834,  1833,  1831,  1830,  1829,\
    1827,  1826,  1824,  1823,  1821,  1820,  1819,  1817,  1816,  1814,\
    1813,  1812,  1810,  1809,  1807,  1806,  1805,  1803,  1802,  1800,\
    1799,  1798,  1796,  1795,  1793,  1792,  1790,  1789,  1788,  1786,\
    1785,  1783,  1782,  1781,  1779,  1778,  1776,  1775,  1774,  1772,\
    1771,  1769,  1768,  1766,  1765,  1764,  1762,  1761,  1759,  1758,\
    1757,  1755,  1754,  1752,  1751,  1749,  1748,  1747,  1745,  1744,\
    1742,  1741,  1739,  1738,  1737,  1735,  1734,  1732,  1731,  1730,\
    1728,  1727,  1725,  1724,  1722,  1721,  1720,  1718,  1717,  1715,\
    1714,  1712,  1711,  1710,  1708,  1707,  1705,  1704,  1702,  1701,\
    1700,  1698,  1697,  1695,  1694,  1692,  1691,  1690,  1688,  1687,\
    1685,  1684,  1682,  1681,  1680,  1678,  1677,  1675,  1674,  1672,\
    1671,  1670,  1668,  1667,  1665,  1664,  1662,  1661,  1659,  1658,\
    1657,  1655,  1654,  1652,  1651,  1649,  1648,  1647,  1645,  1644,\
    1642,  1641,  1639,  1638,  1636,  1635,  1634,  1632,  1631,  1629,\
    1628,  1626,  1625,  1623,  1622,  1621,  1619,  1618,  1616,  1615,\
    1613,  1612,  1611,  1609,  1608,  1606,  1605,  1603,  1602,  1600,\
    1599,  1598,  1596,  1595,  1593,  1592,  1590,  1589,  1587,  1586,\
    1584,  1583,  1582,  1580,  1579,  1577,  1576,  1574,  1573,  1571,\
    1570,  1569,  1567,  1566,  1564,  1563,  1561,  1560,  1558,  1557,\
    1555,  1554,  1553,  1551,  1550,  1548,  1547,  1545,  1544,  1542,\
    1541,  1539,  1538,  1537,  1535,  1534,  1532,  1531,  1529,  1528,\
    1526,  1525,  1523,  1522,  1521,  1519,  1518,  1516,  1515,  1513,\
    1512,  1510,  1509,  1507,  1506,  1504,  1503,  1502,  1500,  1499,\
    1497,  1496,  1494,  1493,  1491,  1490,  1488,  1487,  1485,  1484,\
    1483,  1481,  1480,  1478,  1477,  1475,  1474,  1472,  1471,  1469,\
    1468,  1466,  1465,  1464,  1462,  1461,  1459,  1458,  1456,  1455,\
    1453,  1452,  1450,  1449,  1447,  1446,  1444,  1443,  1441,  1440,\
    1439,  1437,  1436,  1434,  1433,  1431,  1430,  1428,  1427,  1425,\
    1424,  1422,  1421,  1419,  1418,  1416,  1415,  1414,  1412,  1411,\
    1409,  1408,  1406,  1405,  1403,  1402,  1400,  1399,  1397,  1396,\
    1394,  1393,  1391,  1390,  1388,  1387,  1385,  1384,  1383,  1381,\
    1380,  1378,  1377,  1375,  1374,  1372,  1371,  1369,  1368,  1366,\
    1365,  1363,  1362,  1360,  1359,  1357,  1356,  1354,  1353,  1351,\
    1350,  1348,  1347,  1346,  1344,  1343,  1341,  1340,  1338,  1337,\
    1335,  1334,  1332,  1331,  1329,  1328,  1326,  1325,  1323,  1322,\
    1320,  1319,  1317,  1316,  1314,  1313,  1311,  1310,  1308,  1307,\
    1305,  1304,  1302,  1301,  1299,  1298,  1296,  1295,  1293,  1292,\
    1290,  1289,  1288,  1286,  1285,  1283,  1282,  1280,  1279,  1277,\
    1276,  1274,  1273,  1271,  1270,  1268,  1267,  1265,  1264,  1262,\
    1261,  1259,  1258,  1256,  1255,  1253,  1252,  1250,  1249,  1247,\
    1246,  1244,  1243,  1241,  1240,  1238,  1237,  1235,  1234,  1232,\
    1231,  1229,  1228,  1226,  1225,  1223,  1222,  1220,  1219,  1217,\
    1216,  1214,  1213,  1211,  1210,  1208,  1207,  1205,  1204,  1202,\
    1201,  1199,  1198,  1196,  1195,  1193,  1192,  1190,  1189,  1187,\
    1186,  1184,  1183,  1181,  1180,  1178,  1177,  1175,  1174,  1172,\
    1171,  1169,  1168,  1166,  1165,  1163,  1162,  1160,  1159,  1157,\
    1156,  1154,  1153,  1151,  1150,  1148,  1147,  1145,  1144,  1142,\
    1141,  1139,  1138,  1136,  1135,  1133,  1131,  1130,  1128,  1127,\
    1125,  1124,  1122,  1121,  1119,  1118,  1116,  1115,  1113,  1112,\
    1110,  1109,  1107,  1106,  1104,  1103,  1101,  1100,  1098,  1097,\
    1095,  1094,  1092,  1091,  1089,  1088,  1086,  1085,  1083,  1082,\
    1080,  1079,  1077,  1076,  1074,  1072,  1071,  1069,  1068,  1066,\
    1065,  1063,  1062,  1060,  1059,  1057,  1056,  1054,  1053,  1051,\
    1050,  1048,  1047,  1045,  1044,  1042,  1041,  1039,  1038,  1036,\
    1035,  1033,  1032,  1030,  1028,  1027,  1025,  1024,  1022,  1021,\
    1019,  1018,  1016,  1015,  1013,  1012,  1010,  1009,  1007,  1006,\
    1004,  1003,  1001,  1000,   998,   997,   995,   993,   992,   990,\
    989,   987,   986,   984,   983,   981,   980,   978,   977,   975,\
    974,   972,   971,   969,   968,   966,   965,   963,   961,   960,\
    958,   957,   955,   954,   952,   951,   949,   948,   946,   945,\
    943,   942,   940,   939,   937,   935,   934,   932,   931,   929,\
    928,   926,   925,   923,   922,   920,   919,   917,   916,   914,\
    913,   911,   909,   908,   906,   905,   903,   902,   900,   899,\
    897,   896,   894,   893,   891,   890,   888,   886,   885,   883,\
    882,   880,   879,   877,   876,   874,   873,   871,   870,   868,\
    867,   865,   863,   862,   860,   859,   857,   856,   854,   853,\
    851,   850,   848,   847,   845,   844,   842,   840,   839,   837,\
    836,   834,   833,   831,   830,   828,   827,   825,   824,   822,\
    820,   819,   817,   816,   814,   813,   811,   810,   808,   807,\
    805,   804,   802,   800,   799,   797,   796,   794,   793,   791,\
    790,   788,   787,   785,   783,   782,   780,   779,   777,   776,\
    774,   773,   771,   770,   768,   767,   765,   763,   762,   760,\
    759,   757,   756,   754,   753,   751,   750,   748,   746,   745,\
    743,   742,   740,   739,   737,   736,   734,   733,   731,   729,\
    728,   726,   725,   723,   722,   720,   719,   717,   716,   714,\
    712,   711,   709,   708,   706,   705,   703,   702,   700,   699,\
    697,   695,   694,   692,   691,   689,   688,   686,   685,   683,\
    682,   680,   678,   677,   675,   674,   672,   671,   669,   668,\
    666,   664,   663,   661,   660,   658,   657,   655,   654,   652,\
    651,   649,   647,   646,   644,   643,   641,   640,   638,   637,\
    635,   633,   632,   630,   629,   627,   626,   624,   623,   621,\
    619,   618,   616,   615,   613,   612,   610,   609,   607,   606,\
    604,   602,   601,   599,   598,   596,   595,   593,   592,   590,\
    588,   587,   585,   584,   582,   581,   579,   578,   576,   574,\
    573,   571,   570,   568,   567,   565,   564,   562,   560,   559,\
    557,   556,   554,   553,   551,   550,   548,   546,   545,   543,\
    542,   540,   539,   537,   536,   534,   532,   531,   529,   528,\
    526,   525,   523,   522,   520,   518,   517,   515,   514,   512,\
    511,   509,   508,   506,   504,   503,   501,   500,   498,   497,\
    495,   493,   492,   490,   489,   487,   486,   484,   483,   481,\
    479,   478,   476,   475,   473,   472,   470,   469,   467,   465,\
    464,   462,   461,   459,   458,   456,   454,   453,   451,   450,\
    448,   447,   445,   444,   442,   440,   439,   437,   436,   434,\
    433,   431,   430,   428,   426,   425,   423,   422,   420,   419,\
    417,   415,   414,   412,   411,   409,   408,   406,   405,   403,\
    401,   400,   398,   397,   395,   394,   392,   390,   389,   387,\
    386,   384,   383,   381,   379,   378,   376,   375,   373,   372,\
    370,   369,   367,   365,   364,   362,   361,   359,   358,   356,\
    354,   353,   351,   350,   348,   347,   345,   344,   342,   340,\
    339,   337,   336,   334,   333,   331,   329,   328,   326,   325,\
    323,   322,   320,   318,   317,   315,   314,   312,   311,   309,\
    308,   306,   304,   303,   301,   300,   298,   297,   295,   293,\
    292,   290,   289,   287,   286,   284,   282,   281,   279,   278,\
    276,   275,   273,   271,   270,   268,   267,   265,   264,   262,\
    261,   259,   257,   256,   254,   253,   251,   250,   248,   246,\
    245,   243,   242,   240,   239,   237,   235,   234,   232,   231,\
    229,   228,   226,   224,   223,   221,   220,   218,   217,   215,\
    213,   212,   210,   209,   207,   206,   204,   203,   201,   199,\
    198,   196,   195,   193,   192,   190,   188,   187,   185,   184,\
    182,   181,   179,   177,   176,   174,   173,   171,   170,   168,\
    166,   165,   163,   162,   160,   159,   157,   155,   154,   152,\
    151,   149,   148,   146,   144,   143,   141,   140,   138,   137,\
    135,   133,   132,   130,   129,   127,   126,   124,   122,   121,\
    119,   118,   116,   115,   113,   111,   110,   108,   107,   105,\
    104,   102,   100,    99,    97,    96,    94,    93,    91,    90,\
    88,    86,    85,    83,    82,    80,    79,    77,    75,    74,\
    72,    71,    69,    68,    66,    64,    63,    61,    60,    58,\
    57,    55,    53,    52,    50,    49,    47,    46,    44,    42,\
    41,    39,    38,    36,    35,    33,    31,    30,    28,    27,\
    25,    24,    22,    20,    19,    17,    16,    14,    13,    11,\
    9,     8,     6,     5,     3,     2,     1\
};

#endif

#if (_CTE_GET_ANGLE_USE_==CTE_GET_ANGLE_USE_ANG_LUT)
const unsigned char ANGLUT[32][32] =
{
    {128, 180, 204, 216, 224, 229, 233, 236, 238, 240, 241, 242, 243, 244, 245, 246, 246, 247, 247, 248, 248, 249, 249, 249, 249, 250, 250, 250, 250, 251, 251, 251},
    {76, 128, 160, 180, 194, 204, 211, 216, 220, 224, 227, 229, 231, 233, 234, 236, 237, 238, 239, 240, 241, 241, 242, 242, 243, 243, 244, 244, 245, 245, 246, 246},
    {52, 96, 128, 151, 168, 180, 190, 198, 204, 208, 213, 216, 219, 222, 224, 226, 228, 229, 230, 232, 233, 234, 235, 236, 237, 237, 238, 239, 239, 240, 240, 241},
    {40, 76, 105, 128, 146, 160, 171, 180, 188, 194, 199, 204, 207, 211, 214, 216, 218, 220, 222, 224, 225, 227, 228, 229, 230, 231, 232, 233, 234, 234, 235, 236},
    {32, 62, 88, 110, 128, 143, 155, 165, 173, 180, 186, 192, 196, 200, 204, 207, 209, 212, 214, 216, 218, 220, 221, 223, 224, 225, 226, 227, 228, 229, 230, 231},
    {27, 52, 76, 96, 113, 128, 141, 151, 160, 168, 175, 180, 186, 190, 194, 198, 201, 204, 206, 208, 211, 213, 214, 216, 218, 219, 220, 222, 223, 224, 225, 226},
    {23, 45, 66, 85, 101, 115, 128, 139, 148, 156, 164, 170, 176, 180, 185, 189, 192, 196, 198, 201, 204, 206, 208, 210, 212, 213, 215, 216, 217, 219, 220, 221},
    {20, 40, 58, 76, 91, 105, 117, 128, 138, 146, 154, 160, 166, 171, 176, 180, 184, 188, 191, 194, 197, 199, 201, 204, 206, 207, 209, 211, 212, 214, 215, 216},
    {18, 36, 52, 68, 83, 96, 108, 118, 128, 137, 144, 151, 157, 163, 168, 172, 177, 180, 184, 187, 190, 193, 195, 198, 200, 202, 204, 205, 207, 208, 210, 211},
    {16, 32, 48, 62, 76, 88, 100, 110, 119, 128, 136, 143, 149, 155, 160, 165, 169, 173, 177, 180, 184, 186, 189, 192, 194, 196, 198, 200, 202, 204, 205, 207},
    {15, 29, 43, 57, 70, 81, 92, 102, 112, 120, 128, 135, 142, 147, 153, 158, 162, 167, 170, 174, 177, 180, 183, 186, 188, 191, 193, 195, 197, 199, 200, 202},
    {14, 27, 40, 52, 64, 76, 86, 96, 105, 113, 121, 128, 135, 141, 146, 151, 156, 160, 164, 168, 171, 175, 178, 180, 183, 186, 188, 190, 192, 194, 196, 198},
    {13, 25, 37, 49, 60, 70, 80, 90, 99, 107, 114, 121, 128, 134, 140, 145, 150, 154, 158, 162, 166, 169, 172, 175, 178, 180, 183, 185, 187, 189, 191, 193},
    {12, 23, 34, 45, 56, 66, 76, 85, 93, 101, 109, 115, 122, 128, 134, 139, 144, 148, 153, 156, 160, 164, 167, 170, 173, 176, 178, 180, 183, 185, 187, 189},
    {11, 22, 32, 42, 52, 62, 71, 80, 88, 96, 103, 110, 116, 122, 128, 133, 138, 143, 147, 151, 155, 158, 162, 165, 168, 171, 173, 176, 178, 180, 183, 185},
    {10, 20, 30, 40, 49, 58, 67, 76, 84, 91, 98, 105, 111, 117, 123, 128, 133, 138, 142, 146, 150, 154, 157, 160, 163, 166, 169, 171, 174, 176, 178, 180},
    {10, 19, 28, 38, 47, 55, 64, 72, 79, 87, 94, 100, 106, 112, 118, 123, 128, 133, 137, 141, 145, 149, 152, 156, 159, 162, 164, 167, 170, 172, 174, 176},
    {9, 18, 27, 36, 44, 52, 60, 68, 76, 83, 89, 96, 102, 108, 113, 118, 123, 128, 132, 137, 141, 144, 148, 151, 154, 157, 160, 163, 165, 168, 170, 172},
    {9, 17, 26, 34, 42, 50, 58, 65, 72, 79, 86, 92, 98, 103, 109, 114, 119, 124, 128, 132, 136, 140, 143, 147, 150, 153, 156, 159, 161, 164, 166, 169},
    {8, 16, 24, 32, 40, 48, 55, 62, 69, 76, 82, 88, 94, 100, 105, 110, 115, 119, 124, 128, 132, 136, 139, 143, 146, 149, 152, 155, 158, 160, 163, 165},
    {8, 15, 23, 31, 38, 45, 52, 59, 66, 72, 79, 85, 90, 96, 101, 106, 111, 115, 120, 124, 128, 132, 135, 139, 142, 145, 148, 151, 154, 156, 159, 161},
    {7, 15, 22, 29, 36, 43, 50, 57, 63, 70, 76, 81, 87, 92, 98, 102, 107, 112, 116, 120, 124, 128, 132, 135, 138, 142, 145, 147, 150, 153, 155, 158},
    {7, 14, 21, 28, 35, 42, 48, 55, 61, 67, 73, 78, 84, 89, 94, 99, 104, 108, 113, 117, 121, 124, 128, 131, 135, 138, 141, 144, 147, 149, 152, 154},
    {7, 14, 20, 27, 33, 40, 46, 52, 58, 64, 70, 76, 81, 86, 91, 96, 100, 105, 109, 113, 117, 121, 125, 128, 131, 135, 138, 141, 143, 146, 149, 151},
    {7, 13, 19, 26, 32, 38, 44, 50, 56, 62, 68, 73, 78, 83, 88, 93, 97, 102, 106, 110, 114, 118, 121, 125, 128, 131, 134, 137, 140, 143, 145, 148},
    {6, 13, 19, 25, 31, 37, 43, 49, 54, 60, 65, 70, 76, 80, 85, 90, 94, 99, 103, 107, 111, 114, 118, 121, 125, 128, 131, 134, 137, 140, 142, 145},
    {6, 12, 18, 24, 30, 36, 41, 47, 52, 58, 63, 68, 73, 78, 83, 87, 92, 96, 100, 104, 108, 111, 115, 118, 122, 125, 128, 131, 134, 137, 139, 142},
    {6, 12, 17, 23, 29, 34, 40, 45, 51, 56, 61, 66, 71, 76, 80, 85, 89, 93, 97, 101, 105, 109, 112, 115, 119, 122, 125, 128, 131, 134, 136, 139},
    {6, 11, 17, 22, 28, 33, 39, 44, 49, 54, 59, 64, 69, 73, 78, 82, 86, 91, 95, 98, 102, 106, 109, 113, 116, 119, 122, 125, 128, 131, 133, 136},
    {5, 11, 16, 22, 27, 32, 37, 42, 48, 52, 57, 62, 67, 71, 76, 80, 84, 88, 92, 96, 100, 103, 107, 110, 113, 116, 119, 122, 125, 128, 131, 133},
    {5, 10, 16, 21, 26, 31, 36, 41, 46, 51, 56, 60, 65, 69, 73, 78, 82, 86, 90, 93, 97, 101, 104, 107, 111, 114, 117, 120, 123, 125, 128, 131},
    {5, 10, 15, 20, 25, 30, 35, 40, 45, 49, 54, 58, 63, 67, 71, 76, 80, 84, 87, 91, 95, 98, 102, 105, 108, 111, 114, 117, 120, 123, 125, 128}
};

#endif

void iCopy(int* pDO, int* pDI, int len)
{
    // copy data from pDI to pDO, by length of len
    for (int i = 0; i < len; i++)
        pDO[i] = pDI[i];

    //return len;
}

int iCopy_xInt(cplxInt* pDO, cplxInt* pDI, int len)
{
    // copy data from pDI to pDO, by length of len
    for (int i = 0; i < len; ++i)
    {
        pDO[i].I = pDI[i].I;
        pDO[i].Q = pDI[i].Q;
    }

    return len;
}

int FindMaxDec(int* data, int length)
{
    int i = 0;
    int MaxId = 0;
    int temp = data[0];

    for (i = 0; i < length; i++)
    {
        if (data[i] > temp)
        {
            MaxId = i;
            temp = data[i];
        }
    }

    return MaxId;
}

int FindMinDec(int* data, int length)
{
    int i = 0;
    int MinId = 0;
    int temp = data[0];

    for (i = 0; i < length; i++)
    {
        if (data[i] < temp)
        {
            MinId = i;
            temp = data[i];
        }
    }

    return MinId;
}
int iSum(int* data, int length)
{
    int i = 0;
    int sum = 0;

    for (i = 0; i < length; i++)
    {
        sum = sum + data[i];
    }

    return sum;
}

void cplxMatch(cplxInt* a, cplxInt* b, cplxInt* c, int len,int inc, int rSftb)
{
    //c=sum(a*conj(b))
    c[0].I = 0;
    c[0].Q = 0;

    for (int i = 0; i < len; i=i+inc)
    {
        c[0].I = c[0].I + bROUND(a[i].I * b[i].I + a[i].Q * b[i].Q, rSftb);
        c[0].Q = c[0].Q + bROUND(a[i].Q * b[i].I - a[i].I * b[i].Q, rSftb);
    }
}

void cplxDot(cplxInt* a, cplxInt* b, cplxInt* c, int len, int rSftb, int conjMode)
{
    for (int i = 0; i < len; i++)
    {
        if (conjMode)
        {
            //c=(a.*conj(b))
            c[i].I = bROUND(a[i].I * b[i].I + a[i].Q * b[i].Q, rSftb);
            c[i].Q = bROUND(a[i].Q * b[i].I - a[i].I * b[i].Q, rSftb);
        }
        else
        {
            //c=(a.*b)
            c[i].I = bROUND(a[i].I * b[i].I - a[i].Q * b[i].Q, rSftb);
            c[i].Q = bROUND(a[i].Q * b[i].I + a[i].I * b[i].Q, rSftb);
        }
    }
}

int bROUND(int di, int rSft)
{
    //right shift and round
    int out;

    if (rSft <= 0)
    {
        out = di;
    }
    else
    {
        out = (di + (1 << (rSft - 1))) >> rSft;
    }

    return out;
}

int phyWrap(int di, int piBit)
{
    int piInt = (1 << piBit);

    while (di >= piInt)
    {
        di = di - 2 * piInt;
    }

    while (di < -piInt)
    {
        di = di + 2 * piInt;
    }

    return di;
}
#if (_CTE_GET_ANGLE_USE_==CTE_GET_ANGLE_USE_ANG_LUT)
void getAngle(int I, int Q, int* phy, int* rShift)
{
    int limtBW = 7; // determine the divider bitwidth
    int rSft = 0;
    int angle;
    int Imax = (ABS(I) > ABS(Q)) ? 1 : 0;
    int tempmax = Imax ? ABS(I) : ABS(Q);
    int iIdx; //divider output unsighed 5 bit
    int qIdx; //divider output unsighed 5 bit

    //------------------------------------------------
    // Cal the iq index by divider
    //------------------------------------------------
    if (tempmax == 0)
    {
        iIdx = 0;
        qIdx = 0;
    }
    else
    {
        //        int limUp=(int)(pow(2,limtBW)-1);
        //        int limDown=(int)pow(2,limtBW-1);
        int limUp = (1 << limtBW) - 1;
        int limDown = (1 << (limtBW - 1));

        while ((ABS(I) > limUp) || (ABS(Q) > limUp))
        {
            I = I >> 1;
            Q = Q >> 1;
            rSft++;
        }

        while ((ABS(I) < limDown) && (ABS(Q) < limDown))
        {
            I = I << 1;
            Q = Q << 1;
            rSft--;
        }

        if (Imax == 1)
        {
            iIdx = 32;
            qIdx = ABS(Q) * 32 / ABS(I);
        }
        else
        {
            iIdx = ABS(I) * 32 / ABS(Q);
            qIdx = 32;
        }
    }

    //-----------------------------------------------------
    // look up table(AngLut) generate the phase
    //-----------------------------------------------------
    if ((iIdx == 0) && (qIdx == 0))
    {
        angle = 0;
    }
    else if (iIdx == 0)
    {
        if (Q > 0)
            angle = 512 / 2;
        else
            angle = -512 / 2;
    }
    else if (qIdx == 0)
    {
        if (I > 0)
            angle = 0;
        else
            angle = 511;
    }
    else
    {
        if ((I > 0) && (Q > 0))
            angle = ANGLUT[iIdx - 1][qIdx - 1];
        else if ((I > 0) && (Q < 0))
            angle = -ANGLUT[iIdx - 1][qIdx - 1];
        else if ((I < 0) && (Q > 0))
            angle = 512 - ANGLUT[iIdx - 1][qIdx - 1];
        else
            angle = -512 + ANGLUT[iIdx - 1][qIdx - 1];
    }

    if(phy!=NULL)
        *phy = (angle<< (PI_QUNT_BIT - 9));

    if(rShift!=NULL)
        *rShift = rSft;
}
#endif
// atan_codic need check
void atan_Codic (int freq_i, int freq_q, int rSft,int itr,int* phyOut,uint32_t* ampOut)
{
    //itr should  be small than 16
    const int* LUT = COMFUN_CODIC_LUT; //2^16*atan(2^(-n+1)), n = 1:16
    int x[COMFUN_CORDIC_ITR_MAX+1], y[COMFUN_CORDIC_ITR_MAX+1], z[COMFUN_CORDIC_ITR_MAX+1];
    int phy = 0;
    uint32_t amp=0;
    int d = 0;
    int i =0;
    x[0] = freq_i << (rSft);// need check, should avoid overflow
    y[0] = freq_q << (rSft);// need check, should avoid overflow
    z[0] = 0;

    if (itr > COMFUN_CORDIC_ITR_MAX)
    {
        AOA_ERR("[CODIR ITR Max is 14,input is %d\n]",itr);
        itr=COMFUN_CORDIC_ITR_MAX;
    }

    if(ABS(freq_i)>(ABS(x[0]))>>rSft)
    {
        AOA_ERR("[CODIR I rSft too large %d << %d --> %d \n]",freq_i,rSft,x[0]);
    }

    if(ABS(freq_q)>(ABS(y[0]))>>rSft)
    {
        AOA_ERR("[CODIR Q rSft too large %d << %d --> %d \n]",freq_q,rSft,y[0]);
    }

    if ((x[0] == 0) && (y[0] == 0))
    {
        phy = 0;
        amp = 0;
    }
    else if (x[0] == 0)
    {
        phy = (y[0] > 0) ? LUT[0] * 2 : -LUT[0] * 2;
        amp = ABS((y[0]>>(rSft)));
    }
    else if (y[0] == 0)
    {
        phy = (x[0] > 0) ? 0 : LUT[0] * 4;
        amp = ABS((x[0]>>rSft));
    }
    else
    {
        // only porcess the
        for ( i = 1; i < itr + 1; i++)
        {
            d = SIGN(x[i - 1]) * SIGN(y[i - 1]);

            if (d < 0)
            {
                x[i] = x[i - 1] - (((y[i - 1] << 1) + 1) >> (i));
                y[i] = y[i - 1] + (((x[i - 1] << 1) + 1) >> (i));
                z[i] = z[i - 1] - LUT[i - 1];
            }
            else
            {
                x[i] = x[i - 1] + (((y[i - 1] << 1) + 1) >> (i));
                y[i] = y[i - 1] - (((x[i - 1] << 1) + 1) >> (i));
                z[i] = z[i - 1] + LUT[i - 1];
            }

            phy = z[i];
            amp = ABS(x[i]);
        }

        phy = (x[0] < 0) ? ( (phy>0) ? (phy-(LUT[0]<<2)):(phy+(LUT[0]<<2)) ) : phy;
        amp = ((amp>>rSft)*COMFUN_CODIC_AMP_GAIN)>>COMFUN_CODIC_AMP_GAIN_SFT;
    }

    //return (phy>>(ABS(16-PI_QUNT_BIT)));
    if(phyOut!=NULL)
        *phyOut = (phy>>(ABS(16-PI_QUNT_BIT)));

    if(ampOut!=NULL)
        *ampOut = amp;
}


#if (_PHASE_LUT_USE_==PHASE_LUT_USE_TQALUT)
int TqaLut(int x, int tqaPb, int tqaAb, int tqaX2b, int tqaX4b, int tqaComp)
{
    (void)tqaAb;
    (void)tqaAb;
    (void)tqaX2b;
    (void)tqaX4b;
    (void)tqaComp;
    return((int)(PHASE_LUT_TQA_LUT[x]));
}
#else
int TqaFP(int x, int tqaPb, int tqaAb, int tqaX2b, int tqaX4b, int tqaComp)
{
    int PI8Qb = (int)(0.38268 * (1 << tqaPb) + 0.5);
    int xi = (x * PI8Qb + (1 << (tqaPb - 1))) >> tqaPb;
    int xi2, xi2b, xi4, TA1, TA;
    int bsft = 0;
    bsft = 2 * tqaPb - tqaX2b;
    xi2 = (xi * xi + (1 << (bsft - 1))) >> bsft;
    xi2b = (1 << tqaX2b) - xi2;
    bsft = 2 * tqaX2b - tqaX4b;
    xi4 = (xi2 * xi2b + (1 << (bsft - 1))) >> bsft;
    bsft = tqaX4b - (tqaAb - 1);
    TA1 = (1 << (tqaAb - 1)) - ((8 * xi4 + (1 << (bsft - 1))) >> bsft);

    //    if(TA1>((1<<(tqaAb-1))-1))
    //        TA1 = ((1<<(tqaAb-1))-1);

    if (tqaComp > 0)
    {
        int k = 27; //0.84375 =27/32
        int tComp = k * TA1 * ((1 << (tqaAb - 1)) - TA1);
        bsft = 5 + 4 + tqaAb - 1;
        tComp = (tComp + (1 << (bsft - 1))) >> bsft;
        TA = TA1 - tComp;
    }
    else
    {
        TA = TA1;
    }

    return TA;
}

#endif

void TqaNCO(int tqaIn, int* I, int* Q, int tqaComp)
{
    while (tqaIn < 0)
        tqaIn = tqaIn + Pi2Tqa * 4;

    while (tqaIn >= Pi2Tqa * 4)
        tqaIn = tqaIn - Pi2Tqa * 4;

    int tmpPhy = (tqaIn % Pi2Tqa); // wrap  to [0 pi/2)

    if (tqaIn < Pi2Tqa)
    {
        //[0 pi/2)
        if (I != NULL)
            *I = FIXPOINT_TQA(tmpPhy, TqaPb, TqaAb, TqaX2b, TqaX4b, tqaComp);

        if (Q != NULL)
            *Q = FIXPOINT_TQA(Pi2Tqa - tmpPhy, TqaPb, TqaAb, TqaX2b, TqaX4b, tqaComp);
    }
    else if (tqaIn < 2 * Pi2Tqa)
    {
        //[pi/2 pi)
        if (I != NULL)
            *I = -FIXPOINT_TQA(Pi2Tqa - tmpPhy, TqaPb, TqaAb, TqaX2b, TqaX4b, tqaComp);

        if (Q != NULL)
            *Q = FIXPOINT_TQA(tmpPhy, TqaPb, TqaAb, TqaX2b, TqaX4b, tqaComp);
    }
    else if (tqaIn < 3 * Pi2Tqa)
    {
        //[pi 3*pi/2)
        if (I != NULL)
            *I = -FIXPOINT_TQA(tmpPhy, TqaPb, TqaAb, TqaX2b, TqaX4b, tqaComp);

        if (Q != NULL)
            *Q = -FIXPOINT_TQA(Pi2Tqa - tmpPhy, TqaPb, TqaAb, TqaX2b, TqaX4b, tqaComp);
    }
    else
    {
        //[3*pi/2 2pi)
        if (I != NULL)
            *I = FIXPOINT_TQA(Pi2Tqa - tmpPhy, TqaPb, TqaAb, TqaX2b, TqaX4b, tqaComp);

        if (Q != NULL)
            *Q = -FIXPOINT_TQA(tmpPhy, TqaPb, TqaAb, TqaX2b, TqaX4b, tqaComp);
    }
}

int TqaCOS(int tqaIn)
{
    int I;
    TqaNCO(tqaIn, &I, NULL, 1);
    return I;
}

int TqaSIN(int tqaIn)
{
    int Q;
    TqaNCO(tqaIn, NULL, &Q, 1);
    return Q;
}

uint32_t absHW(int I, int Q)
{
    if ((ABS(I) - ABS(Q)) > 0)
        return (ABS(I) + (ABS(Q) >> 2));
    else
        return (ABS(Q) + (ABS(I) >> 2));
}

uint32_t absHWX(cplxInt a)
{
    int I = a.I;
    int Q = a.Q;

    if ((ABS(I) - ABS(Q)) > 0)
        return (ABS(I) + (ABS(Q) >> 2));
    else
        return (ABS(Q) + (ABS(I) >> 2));
}
uint32_t absHWCodic(cplxInt a)
{
    int I = a.I;
    int Q = a.Q;
    uint32_t amp;
    atan_Codic(I,Q,COMFUN_CODIC_RSFT,COMFUN_CORDIC_ITR_MAX,NULL,&amp);
    return amp;
}

uint32_t g_tcTicTick0=0;
uint32_t g_tcTicTick1=0;
extern uint32_t rtc_get_counter(void);
void time_cost_dbg_tic(void)
{
    g_tcTicTick0 = rtc_get_counter();
}
void time_cost_dbg_toc(char* a)
{
    g_tcTicTick1 = rtc_get_counter();
    uint32_t tmp = (g_tcTicTick1>g_tcTicTick0) ? g_tcTicTick1-g_tcTicTick0 :(0x3fffff-g_tcTicTick0+g_tcTicTick1);
    AOA_TIM("%s",a);
    AOA_TIM("%6d %6d\n",tmp,tmp*32);
    time_cost_dbg_tic();
}

